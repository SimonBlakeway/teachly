<!DOCTYPE html>
<html lang="{{context.language}}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-2/css/all.min.css"
    integrity="sha256-46r060N2LrChLLb5zowXQ72/iKKNiw/lAmygmHExk/o=" crossorigin="anonymous"
    nonce="{{context.settings.cspNonce}}" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    nonce="{{context.settings.cspNonce}}"></script>
  <link rel="icon" type="image/x-icon" href="/images/favicon.ico.png" nonce="{{context.settings.cspNonce}}">
  <script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"
    nonce="{{context.settings.cspNonce}}"></script>
  <link rel="stylesheet" href="/css/main.css" nonce="{{context.settings.cspNonce}}">
  <link rel="stylesheet" href="/css/utils.css" nonce="{{context.settings.cspNonce}}">

  <link rel="stylesheet" href="/css/animationUtil.css" nonce="{{context.settings.cspNonce}}">

  {{#if context.bodyContext.title}}
  <title>{{context.bodyContext.title}}</title>
  {{else}}
  <title>{{context.bodyContext.titleUpdate.pre}}{{context.settings.title}}{{context.bodyContext.titleUpdate.post}}
  </title>
  {{/if}}
</head>
<script nonce="{{context.settings.cspNonce}}">
  const userLang = "{{context.settings.lang}}"
  const userCur = "{{context.settings.cur}}"
  var curConversionRatio = "{{context.settings.curRatio}}"

  {{#if context.settings.isUser }}
  var lastRefresh = {{ context.settings.token_created_at }}
  {{/if}}

      function prettyifyDate(date) { // it comes in as seconds from epoch
        try {

          if (typeof date != "number") return date
          // I made this with no internet, pls ignore horrible conditional
          if (`${date}` == "NaN") return ""

          var secs = Math.floor(Date.now() / 1000) - date
          if (secs <= 1) return "1 second ago"
          if (secs < 60) return "{{context.layoutContext.secsAgoPrier}}" + secs + " seconds ago" //"{{context.layoutContext.secsAgoPost}}";
          if (secs < 3600) return "{{context.layoutContext.minAgoPrier}}" + Math.floor(secs / 60) + "{{context.layoutContext.minAgoPost}}";
          if (secs < 86400) return "{{context.layoutContext.hourAgoPrier}}" + Math.floor(secs / 3600) + "{{context.layoutContext.hourAgoPost}}";
          if (secs < 604800) return "{{context.layoutContext.daysAgoPrier}}" + Math.floor(secs / 86400) + "{{context.layoutContext.daysAgoPost}}";
          return new Date(secs * 1000).toLocaleDateString();
        }
        catch (err) {
          console.log(err)
          return ""
        }
      }

      function updateDates() {
        dates = document.getElementsByClassName("date")
        for (let i = 0; i < dates.length; i++) {
          try { // the try is here because I don't want an error to break the loop
            num = parseInt(dates[i].children[0].innerHTML)
            dates[i].children[1].innerHTML = prettyifyDate(num)
          }
          catch (err) {
            console.log(err)
          }
        }
      }
</script>
<script src="/js/mainLayout.js" nonce="{{context.settings.cspNonce}}"></script>
<body>
<style nonce="{{context.settings.cspNonce}}">
  .bg-333 {background-color: #333;}
  .top-0 {top: 0;}
  .left-0 {left:0px;}
  .w-100 {width: 100%;} 
  .h-100 {height: 100%;}
  .z-index-max {z-index: 2147483647;}
</style>
<div id="loadOverlay" class="bg-333 top-0 left-0 w-100 h-100 z-index-max"></div>

  {{#if context.navbar}}
  {{> _navbar navbarContext = context.navbar settings = context.settings}}
  {{/if}}
  {{#if context.userNavbar}}
  {{> _userNavbar navbarContext = context.userNavbar settings = context.settings}}
  {{/if}}
  {{{body}}}
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"
    nonce="{{context.settings.cspNonce}}">
  {{#if context.footer}}
  {{>_footer footerContext = context.footer companyInfo = context.companyInfo settings = context.settings}}
  {{/if}}
  {{#if context.cookiesPopup}}
  {{>_cookiesPopup cookiesText = context.cookiesPopup}}
  {{/if}}

  <div class="position-fixed top-80 w-300p" id="screen-notifications"></div>
</body>
</html>